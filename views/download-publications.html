<div class="download-container">
    <div class="search-section">
        <h3>Search Patent Publications</h3>
        <p>Search and download patent publications from USPTO and Espacenet databases.</p>
        
        <form id="search-form" class="search-form">
            <div class="search-grid">
                <div class="form-group">
                    <label for="search-query">Search Query</label>
                    <input 
                        type="text" 
                        id="search-query" 
                        name="searchQuery"
                        placeholder="Enter keywords, patent numbers, or inventor names"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="search-type">Search Type</label>
                    <select id="search-type" name="searchType">
                        <option value="keyword">Keyword Search</option>
                        <option value="patent-number">Patent Number</option>
                        <option value="inventor">Inventor Name</option>
                        <option value="assignee">Assignee</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="database">Database</label>
                    <select id="database" name="database">
                        <option value="both">Both USPTO & Espacenet</option>
                        <option value="uspto">USPTO Only</option>
                        <option value="espacenet">Espacenet Only</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="date-range">Date Range</label>
                    <select id="date-range" name="dateRange">
                        <option value="all">All Dates</option>
                        <option value="last-year">Last Year</option>
                        <option value="last-5-years">Last 5 Years</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
            </div>

            <div class="date-inputs" id="custom-date-range" style="display: none;">
                <div class="form-group">
                    <label for="start-date">Start Date</label>
                    <input type="date" id="start-date" name="startDate">
                </div>
                <div class="form-group">
                    <label for="end-date">End Date</label>
                    <input type="date" id="end-date" name="endDate">
                </div>
            </div>

            <div class="search-actions">
                <button type="submit" id="search-patents" class="btn btn-primary">
                    üîç Search Patents
                </button>
                <button type="button" id="clear-search" class="btn btn-secondary">
                    Clear
                </button>
            </div>
        </form>
    </div>

    <div class="results-section" id="results-section" style="display: none;">
        <div class="results-header">
            <h3>Search Results</h3>
            <div class="results-info">
                <span id="results-count">0 results found</span>
                <div class="results-actions">
                    <button id="select-all" class="btn btn-secondary">Select All</button>
                    <button id="download-selected" class="btn btn-success">Download Selected</button>
                </div>
            </div>
        </div>

        <div class="results-table-container">
            <table class="table" id="results-table">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="select-all-checkbox"></th>
                        <th>Patent Number</th>
                        <th>Title</th>
                        <th>Inventor(s)</th>
                        <th>Assignee</th>
                        <th>Publication Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="results-tbody">
                    <!-- Results will be populated here -->
                </tbody>
            </table>
        </div>

        <div class="pagination" id="pagination">
            <!-- Pagination controls will be added here -->
        </div>
    </div>

    <div class="download-progress" id="download-progress" style="display: none;">
        <h3>Download Progress</h3>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-info">
            <span id="progress-text">Preparing download...</span>
            <span id="progress-percentage">0%</span>
        </div>
    </div>
</div>

<style>
.download-container {
    max-width: 1200px;
}

.search-section {
    background: white;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.search-section h3 {
    color: #2c3e50;
    margin-bottom: 12px;
    font-size: 1.2em;
}

.search-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    margin-bottom: 20px;
}

.search-form select {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    background-color: white;
}

.date-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-top: 16px;
}

.search-actions {
    display: flex;
    gap: 12px;
    margin-top: 20px;
}

.results-section {
    background: white;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 16px;
}

.results-info {
    display: flex;
    align-items: center;
    gap: 16px;
    flex-wrap: wrap;
}

.results-actions {
    display: flex;
    gap: 8px;
}

.results-table-container {
    overflow-x: auto;
    margin-bottom: 20px;
}

.table th {
    white-space: nowrap;
}

.table td {
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.table td.title {
    max-width: 300px;
}

.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
}

.pagination button {
    padding: 8px 12px;
    border: 1px solid #ddd;
    background: white;
    cursor: pointer;
    border-radius: 4px;
}

.pagination button:hover {
    background: #f8f9fa;
}

.pagination button.active {
    background: #3498db;
    color: white;
    border-color: #3498db;
}

.download-progress {
    background: white;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.progress-bar {
    width: 100%;
    height: 20px;
    background: #f0f0f0;
    border-radius: 10px;
    overflow: hidden;
    margin: 16px 0;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #3498db, #2980b9);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #666;
}

/* Responsive design */
@media (max-width: 768px) {
    .search-grid {
        grid-template-columns: 1fr;
    }
    
    .date-inputs {
        grid-template-columns: 1fr;
    }
    
    .results-header {
        flex-direction: column;
        align-items: stretch;
    }
    
    .results-info {
        justify-content: space-between;
    }
}
</style>

<script>
// Download publications specific JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    const dateRangeSelect = document.getElementById('date-range');
    const customDateRange = document.getElementById('custom-date-range');
    const resultsSection = document.getElementById('results-section');
    const selectAllCheckbox = document.getElementById('select-all-checkbox');
    
    // Show/hide custom date range
    dateRangeSelect.addEventListener('change', function() {
        if (this.value === 'custom') {
            customDateRange.style.display = 'block';
        } else {
            customDateRange.style.display = 'none';
        }
    });
    
    // Handle search form submission
    searchForm.addEventListener('submit', function(e) {
        e.preventDefault();
        performSearch();
    });
    
    // Clear search
    document.getElementById('clear-search').addEventListener('click', function() {
        searchForm.reset();
        customDateRange.style.display = 'none';
        resultsSection.style.display = 'none';
    });
    
    // Select all checkbox functionality
    selectAllCheckbox.addEventListener('change', function() {
        const checkboxes = document.querySelectorAll('#results-tbody input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
        });
    });
    
    function performSearch() {
        // Show loading
        const searchButton = document.getElementById('search-patents');
        const originalText = searchButton.textContent;
        searchButton.textContent = 'Searching...';
        searchButton.disabled = true;
        
        // Simulate search (replace with actual API calls)
        setTimeout(() => {
            displayMockResults();
            searchButton.textContent = originalText;
            searchButton.disabled = false;
        }, 2000);
    }
    
    function displayMockResults() {
        const mockResults = [
            {
                id: 1,
                patentNumber: 'US10123456B2',
                title: 'Method and System for Advanced Machine Learning',
                inventors: 'Smith, John; Doe, Jane',
                assignee: 'Tech Corp Inc.',
                publicationDate: '2023-01-15',
                status: 'Granted'
            },
            {
                id: 2,
                patentNumber: 'US10234567B2',
                title: 'Artificial Intelligence Processing Unit',
                inventors: 'Johnson, Bob',
                assignee: 'AI Systems LLC',
                publicationDate: '2023-02-20',
                status: 'Granted'
            }
        ];
        
        const tbody = document.getElementById('results-tbody');
        tbody.innerHTML = '';
        
        mockResults.forEach(result => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="checkbox" value="${result.id}"></td>
                <td>${result.patentNumber}</td>
                <td class="title" title="${result.title}">${result.title}</td>
                <td>${result.inventors}</td>
                <td>${result.assignee}</td>
                <td>${result.publicationDate}</td>
                <td><span class="status-badge status-granted">${result.status}</span></td>
                <td>
                    <button class="btn btn-sm btn-primary" onclick="downloadSingle('${result.patentNumber}')">
                        Download
                    </button>
                </td>
            `;
            tbody.appendChild(row);
        });
        
        document.getElementById('results-count').textContent = `${mockResults.length} results found`;
        resultsSection.style.display = 'block';
    }
});

function downloadSingle(patentNumber) {
    alert(`Downloading patent: ${patentNumber}`);
}
</script>
